/* ==========================================================================
   Walnut UI Framework (walnut-ui.css)
   - All common UI: Typography, Buttons, Cards, Forms, Code, Chat, Hero,
     Media, Particles, Modals, Tooltips, Dropdowns, Tabs, Accordions,
     Animations, Utilities, Responsive helpers, Dynamic color variables.
   - Presets: glass | sleek | solid (controlled by JS via data-walnut-style
     on <html> or <body>, and CSS variables injected by JS).
   - Safe to use standalone OR let walnut-ui.js inject this automatically.
   ========================================================================== */

/* ------------------------------
   Root Variables (dynamic via JS)
   ------------------------------ */
:root {
  /* Theme colors (overridden by JS) */
  --primary-color: #7c3aed;   /* primary */
  --secondary-color: #14b8a6; /* secondary */
  --accent-color: #f59e0b;    /* accent */

  /* Base palette (auto-tuned by JS) */
  --bg: #0b0b12;
  --bg-muted: #101018;
  --surface: #131324;
  --surface-2: #181832;
  --text: #e7e7f0;
  --text-muted: #b9b9c7;
  --border: rgba(255,255,255,0.12);

  /* Effects */
  --glass-bg: rgba(255,255,255,0.06);
  --glass-stroke: rgba(255,255,255,0.12);
  --glow: 0 0 0 rgba(0,0,0,0);
  --shadow-sm: 0 4px 12px rgba(0,0,0,0.18);
  --shadow-md: 0 12px 30px rgba(0,0,0,0.22);
  --shadow-lg: 0 24px 60px rgba(0,0,0,0.28);

  /* Radii / layout scales */
  --r-xs: 8px;
  --r-sm: 12px;
  --r-md: 16px;
  --r-lg: 20px;
  --r-xl: 28px;

  --content-max: 1200px;

  /* Typography scale */
  --font-sans: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Inter, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";
  --font-mono: ui-monospace, SFMono-Regular, Menlo, Monaco, "Courier New", monospace;

  --h1: clamp(2.2rem, 1.4rem + 3vw, 4rem);
  --h2: clamp(1.8rem, 1.1rem + 2.4vw, 3rem);
  --h3: clamp(1.5rem, 1rem + 1.6vw, 2.25rem);
  --h4: clamp(1.25rem, 0.95rem + 1.2vw, 1.75rem);
  --h5: 1.125rem;
  --h6: 1rem;
  --p: 1rem;
  --lead: 1.125rem;
  --lh: 1.6;

  /* Motion */
  --speed-fast: 140ms;
  --speed: 220ms;
  --speed-slow: 380ms;

  /* Opacities */
  --hover-opacity: 0.92;
  --muted-opacity: 0.72;

  /* Particle defaults */
  --particles-count: 40;
  --particles-size-min: 2px;
  --particles-size-max: 6px;
}

/* Base reset-ish */
*, *::before, *::after { box-sizing: border-box; }
html, body { height: 100%; }
body {
  margin: 0;
  color: var(--text);
  background: radial-gradient(1200px 800px at 20% -10%, rgba(255,255,255,0.06), transparent 60%),
              radial-gradient(1000px 600px at 120% 10%, rgba(255,255,255,0.04), transparent 60%),
              linear-gradient(180deg, var(--bg), var(--bg-muted));
  font-family: var(--font-sans);
  line-height: var(--lh);
  -webkit-font-smoothing: antialiased;
  text-rendering: optimizeLegibility;
}

/* Content container */
.w-container { width: min(100%, var(--content-max)); margin-inline: auto; padding-inline: 1rem; }

/* ------------------------------
   Typography
   ------------------------------ */
h1, h2, h3, h4, h5, h6 {
  margin: 0.75em 0 0.35em;
  font-weight: 700;
  letter-spacing: -0.02em;
  text-shadow: 0 1px 0 rgba(0,0,0,0.35);
}
h1 { font-size: var(--h1); }
h2 { font-size: var(--h2); }
h3 { font-size: var(--h3); }
h4 { font-size: var(--h4); }
h5 { font-size: var(--h5); }
h6 { font-size: var(--h6); }

p { margin: 0.75em 0; font-size: var(--p); }
.lead { font-size: var(--lead); opacity: var(--hover-opacity); }

a {
  color: var(--accent-color);
  text-decoration: none;
  position: relative;
  transition: color var(--speed) ease, text-shadow var(--speed) ease;
}
a:hover { color: var(--primary-color); text-shadow: 0 0 14px color-mix(in oklab, var(--primary-color) 60%, transparent); }

ul, ol { margin: 0.75em 0 0.75em 1.25em; }
li + li { margin-top: 0.25em; }

blockquote {
  margin: 1rem 0;
  padding: 1rem 1.25rem;
  border-left: 3px solid var(--secondary-color);
  background: color-mix(in oklab, var(--surface) 85%, var(--secondary-color) 15%);
  box-shadow: var(--shadow-sm);
  border-radius: var(--r-sm);
  opacity: var(--hover-opacity);
}

/* ------------------------------
   Buttons
   ------------------------------ */
.w-btn {
  --btn-bg: var(--primary-color);
  --btn-fg: white;
  --btn-border: transparent;
  appearance: none;
  display: inline-flex; align-items: center; justify-content: center;
  gap: 0.5rem;
  padding: 0.7rem 1rem;
  border: 1px solid var(--btn-border);
  background: var(--btn-bg);
  color: var(--btn-fg);
  border-radius: var(--r-md);
  cursor: pointer;
  transition: transform var(--speed) ease, box-shadow var(--speed) ease, opacity var(--speed-fast) ease, background var(--speed) ease;
  box-shadow: var(--shadow-sm);
  will-change: transform, box-shadow;
}
.w-btn:hover { transform: translateY(-2px) scale(1.02); opacity: var(--hover-opacity); }
.w-btn:active { transform: translateY(0) scale(0.98); }
.w-btn.icon { padding: 0.6rem 0.75rem; }
.w-btn.secondary { --btn-bg: var(--secondary-color); }
.w-btn.accent { --btn-bg: var(--accent-color); }
.w-btn.ghost { --btn-bg: transparent; --btn-fg: var(--text); --btn-border: var(--border); }
.w-btn.block { width: 100%; }

/* Style variants (glass/sleek/solid) */
[data-walnut-style="glass"] .w-btn {
  background: linear-gradient(180deg, color-mix(in oklab, var(--btn-bg) 40%, white 5%), color-mix(in oklab, var(--btn-bg) 70%, transparent 20%));
  backdrop-filter: blur(8px);
  border-color: color-mix(in oklab, var(--btn-bg) 30%, white 20%);
  box-shadow: 0 8px 30px color-mix(in oklab, var(--btn-bg) 35%, black 65%);
}
[data-walnut-style="sleek"] .w-btn {
  border-color: color-mix(in oklab, var(--btn-bg) 35%, black 65%);
  box-shadow: inset 0 1px 0 rgba(255,255,255,0.12), var(--shadow-md);
}
[data-walnut-style="solid"] .w-btn {
  background: var(--btn-bg);
  border-color: transparent;
  box-shadow: var(--shadow-md);
}

/* Hover glow */
.w-btn.glow:hover {
  box-shadow: 0 0 0 6px color-mix(in oklab, var(--btn-bg) 30%, transparent),
              0 12px 36px color-mix(in oklab, var(--btn-bg) 40%, black 60%);
}

/* ------------------------------
   Cards
   ------------------------------ */
.w-card {
  position: relative;
  border-radius: var(--r-lg);
  padding: 1.0rem;
  background: var(--surface);
  border: 1px solid var(--border);
  box-shadow: var(--shadow-sm);
  transition: transform var(--speed) ease, box-shadow var(--speed) ease, background var(--speed) ease;
}
.w-card:hover { transform: translateY(-4px); box-shadow: var(--shadow-md); }
.w-card .w-card-title { font-weight: 700; margin-bottom: 0.25rem; font-size: 1.125rem; }
.w-card .w-card-subtle { color: var(--text-muted); font-size: 0.95rem; }

/* Card variants */
.w-card.glass {
  background: color-mix(in oklab, var(--glass-bg) 100%, var(--surface) 0%);
  backdrop-filter: blur(8px);
  border: 1px solid var(--glass-stroke);
}
.w-card.sleek {
  background: linear-gradient(180deg, color-mix(in oklab, var(--surface) 90%, white 4%), var(--surface-2));
}
.w-card.solid { background: var(--surface-2); }

/* Hover gradient overlay */
.w-card:hover::after {
  content: "";
  position: absolute; inset: 0;
  pointer-events: none;
  background: radial-gradient(500px 500px at var(--x, 50%) var(--y, 50%), color-mix(in oklab, var(--primary-color) 18%, transparent), transparent 60%);
  border-radius: inherit;
  opacity: 0.7;
}

/* ------------------------------
   Forms
   ------------------------------ */
.w-input, .w-textarea, .w-select {
  width: 100%;
  color: var(--text);
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--r-md);
  padding: 0.7rem 0.9rem;
  outline: none;
  transition: border-color var(--speed) ease, box-shadow var(--speed) ease, background var(--speed) ease;
  box-shadow: inset 0 0 0 0 transparent;
}
.w-textarea { min-height: 120px; resize: vertical; }
.w-select { appearance: none; background-image: linear-gradient(45deg, transparent 50%, var(--text) 50%), linear-gradient(135deg, var(--text) 50%, transparent 50%); background-position: calc(100% - 20px) calc(1em + 2px), calc(100% - 15px) calc(1em + 2px); background-size: 5px 5px, 5px 5px; background-repeat: no-repeat; }
.w-input:hover, .w-textarea:hover, .w-select:hover { border-color: color-mix(in oklab, var(--primary-color) 40%, var(--border)); }
.w-input:focus, .w-textarea:focus, .w-select:focus {
  border-color: var(--primary-color);
  box-shadow: 0 0 0 6px color-mix(in oklab, var(--primary-color) 20%, transparent);
}

/* Checkboxes / Radios */
.w-check, .w-radio { display: inline-flex; align-items: center; gap: 0.5rem; cursor: pointer; }
.w-check input[type="checkbox"], .w-radio input[type="radio"] {
  width: 1.1rem; height: 1.1rem; accent-color: var(--primary-color);
}

/* Validation helpers */
.is-invalid { border-color: color-mix(in oklab, var(--accent-color) 70%, red 15%); }
.is-valid { border-color: color-mix(in oklab, var(--secondary-color) 70%, white 8%); }

/* ------------------------------
   Code Blocks
   ------------------------------ */
pre, code { font-family: var(--font-mono); }
pre.w-code {
  position: relative;
  background: #0b0d16;
  color: #e8eaf6;
  padding: 1rem 1.25rem;
  border-radius: var(--r-md);
  border: 1px solid var(--border);
  overflow: auto;
  box-shadow: var(--shadow-sm);
}
pre.w-code .w-copy {
  position: absolute; top: 10px; right: 10px;
  font-size: 12px; padding: 0.3rem 0.5rem; border-radius: var(--r-sm);
  background: var(--surface-2); color: var(--text); border: 1px solid var(--border);
  cursor: pointer; transition: opacity var(--speed-fast) ease;
}
pre.w-code:hover .w-copy { opacity: 0.9; }

/* Very light syntax highlight (CSS-only heuristic) */
code .kw { color: #80c7ff; }
code .fn { color: #a5d6a7; }
code .st { color: #ffd59e; }
code .num { color: #f8a1ff; }
code .cm { color: #8b90a3; font-style: italic; }

/* ------------------------------
   Chat Bubbles
   ------------------------------ */
.w-chat {
  display: grid; gap: 0.65rem;
}
.w-bubble {
  max-width: 85%;
  padding: 0.65rem 0.85rem;
  border-radius: 16px;
  box-shadow: var(--shadow-sm);
  animation: fadeIn var(--speed-slow) ease both;
}
.w-bubble.left {
  background: color-mix(in oklab, var(--surface) 85%, var(--secondary-color) 15%);
  border-bottom-left-radius: 4px;
}
.w-bubble.right {
  margin-left: auto;
  background: linear-gradient(135deg, color-mix(in oklab, var(--primary-color) 60%, transparent), color-mix(in oklab, var(--accent-color) 40%, transparent));
  border-bottom-right-radius: 4px;
}
.w-typing {
  display: inline-flex; gap: 6px; align-items: center;
}
.w-typing .dot {
  width: 6px; height: 6px; border-radius: 50%;
  background: white; opacity: 0.85;
  animation: bounce 1.2s infinite ease-in-out;
}
.w-typing .dot:nth-child(2){ animation-delay: .15s; }
.w-typing .dot:nth-child(3){ animation-delay: .3s; }

/* ------------------------------
   Hero Sections
   ------------------------------ */
.w-hero {
  position: relative;
  display: grid; place-items: center;
  padding: clamp(3rem, 6vw, 8rem) 1rem;
  text-align: center;
  overflow: hidden;
  border-bottom: 1px solid var(--border);
}
.w-hero .w-hero-inner { width: min(100%, 1000px); z-index: 1; }
.w-hero .w-hero-eyebrow { color: var(--text-muted); letter-spacing: .12em; text-transform: uppercase; font-weight: 600; }
.w-hero .w-hero-title { font-size: var(--h1); margin-top: .35em; }
.w-hero .w-hero-sub { font-size: var(--lead); opacity: var(--hover-opacity); margin-top: .5em; }

.w-hero.gradient {
  background: radial-gradient(1200px 600px at 10% -10%, color-mix(in oklab, var(--primary-color) 18%, transparent), transparent 60%),
              radial-gradient(1000px 600px at 110% 10%, color-mix(in oklab, var(--secondary-color) 16%, transparent), transparent 60%),
              linear-gradient(180deg, var(--bg), var(--bg-muted));
}
.w-hero .w-hero-overlay {
  position: absolute; inset: 0; z-index: 0;
  pointer-events: none;
  background: radial-gradient(1400px 700px at 50% 0%, color-mix(in oklab, var(--accent-color) 10%, transparent), transparent 70%);
}

/* ------------------------------
   Media
   ------------------------------ */
.w-media {
  display: block; width: 100%; border-radius: var(--r-md);
  border: 1px solid var(--border);
  box-shadow: var(--shadow-sm);
  transition: transform var(--speed) ease, box-shadow var(--speed) ease, filter var(--speed) ease;
}
.w-media:hover { transform: translateY(-2px) scale(1.01); box-shadow: var(--shadow-md); filter: saturate(1.08); }

.w-video {
  width: 100%; border: 1px solid var(--border); border-radius: var(--r-md);
  background: black; box-shadow: var(--shadow-sm);
}

/* ------------------------------
   Particles (canvas container)
   ------------------------------ */
.w-particles {
  position: absolute; inset: 0; overflow: hidden; z-index: 0; pointer-events: none;
}
.w-particles canvas { width: 100%; height: 100%; display: block; }

/* ------------------------------
   Interactive Components
   ------------------------------ */
/* Modal */
.w-modal-backdrop {
  position: fixed; inset: 0; background: rgba(0,0,0,0.55);
  display: none; align-items: center; justify-content: center;
  z-index: 999;
}
.w-modal-backdrop.open { display: flex; animation: fadeIn var(--speed) both; }
.w-modal {
  width: min(92vw, 720px);
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--r-lg);
  box-shadow: var(--shadow-lg);
  padding: 1rem;
  transform: translateY(12px);
  animation: slideUp var(--speed) ease both;
}

/* Tooltip */
.w-tooltip {
  position: absolute; z-index: 1000; pointer-events: none;
  background: var(--surface-2);
  color: var(--text);
  border: 1px solid var(--border);
  border-radius: var(--r-sm);
  padding: 0.35rem 0.5rem;
  font-size: 0.85rem;
  box-shadow: var(--shadow-sm);
  opacity: 0; transform: translateY(6px);
  transition: opacity var(--speed) ease, transform var(--speed) ease;
}
.w-tooltip.show { opacity: 1; transform: translateY(0); }

/* Dropdown */
.w-dropdown { position: relative; display: inline-block; }
.w-dropdown-menu {
  position: absolute; top: calc(100% + 8px); right: 0;
  min-width: 200px; background: var(--surface); border: 1px solid var(--border);
  border-radius: var(--r-md); box-shadow: var(--shadow-md); padding: 0.35rem; display: none; z-index: 999;
}
.w-dropdown.open .w-dropdown-menu { display: block; animation: fadeIn var(--speed) both; }
.w-dropdown-item { padding: 0.55rem 0.65rem; border-radius: var(--r-sm); cursor: pointer; }
.w-dropdown-item:hover { background: color-mix(in oklab, var(--surface-2) 70%, var(--primary-color) 30%); }

/* Tabs */
.w-tabs { display: grid; gap: 0.5rem; }
.w-tab-list { display: flex; gap: 0.35rem; flex-wrap: wrap; }
.w-tab {
  padding: 0.55rem 0.85rem; border: 1px solid var(--border); border-radius: var(--r-md);
  background: var(--surface); cursor: pointer; transition: background var(--speed) ease;
}
.w-tab[aria-selected="true"] { background: color-mix(in oklab, var(--surface) 80%, var(--primary-color) 20%); }
.w-tab-panels { border: 1px solid var(--border); border-radius: var(--r-md); padding: 0.75rem; background: var(--surface); }

/* Accordion */
.w-accordion { border: 1px solid var(--border); border-radius: var(--r-md); overflow: hidden; }
.w-acc-item + .w-acc-item { border-top: 1px solid var(--border); }
.w-acc-trigger { width: 100%; text-align: left; background: var(--surface); padding: 0.75rem 1rem; cursor: pointer; border: 0; color: var(--text); display: flex; align-items: center; justify-content: space-between; }
.w-acc-panel { display: grid; grid-template-rows: 0fr; transition: grid-template-rows var(--speed) ease; }
.w-acc-panel.open { grid-template-rows: 1fr; }
.w-acc-content { overflow: hidden; padding: 0 1rem 0; }
.w-acc-panel.open .w-acc-content { padding: 0.75rem 1rem 1rem; }

/* ------------------------------
   Animations
   ------------------------------ */
@keyframes fadeIn { from { opacity: 0 } to { opacity: 1 } }
@keyframes slideUp { from { opacity: 0; transform: translateY(18px) } to { opacity: 1; transform: translateY(0) } }
@keyframes glowPulse { 0%,100% { box-shadow: var(--glow) } 50% { box-shadow: 0 0 32px color-mix(in oklab, var(--primary-color) 40%, transparent) } }
@keyframes bounce { 0%,80%,100% { transform: translateY(0) } 40% { transform: translateY(-6px) } }

/* ------------------------------
   Utilities
   ------------------------------ */
.hidden { display: none !important; }
.block { display: block !important; }
.inline { display: inline !important; }
.flex { display: flex !important; }
.grid { display: grid !important; }

.center { margin-inline: auto; }
.content { width: min(100%, var(--content-max)); margin-inline: auto; }

.rounded { border-radius: var(--r-md); }
.rounded-lg { border-radius: var(--r-lg); }
.shadow { box-shadow: var(--shadow-sm); }
.shadow-lg { box-shadow: var(--shadow-lg); }

.m-0 { margin: 0 !important; }
.mt-1 { margin-top: .25rem !important; } .mt-2 { margin-top: .5rem !important; } .mt-3 { margin-top: .75rem !important; } .mt-4 { margin-top: 1rem !important; }
.mb-1 { margin-bottom: .25rem !important; } .mb-2 { margin-bottom: .5rem !important; } .mb-3 { margin-bottom: .75rem !important; } .mb-4 { margin-bottom: 1rem !important; }
.p-1 { padding: .25rem !important; } .p-2 { padding: .5rem !important; } .p-3 { padding: .75rem !important; } .p-4 { padding: 1rem !important; }

.grid-2 { display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; }
.grid-3 { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; }
.grid-4 { display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem; }
@media (max-width: 1024px) {
  .grid-4 { grid-template-columns: repeat(2, 1fr); }
}
@media (max-width: 640px) {
  .grid-3 { grid-template-columns: 1fr; }
  .grid-2 { grid-template-columns: 1fr; }
}

/* ------------------------------
   Preset Surfaces (glass/sleek/solid)
   ------------------------------ */
[data-walnut-style="glass"] .w-surface {
  background: var(--glass-bg);
  backdrop-filter: blur(10px) saturate(1.05);
  border: 1px solid var(--glass-stroke);
}
[data-walnut-style="sleek"] .w-surface {
  background: linear-gradient(180deg, color-mix(in oklab, var(--surface) 90%, white 4%), var(--surface-2));
  border: 1px solid var(--border);
}
[data-walnut-style="solid"] .w-surface {
  background: var(--surface-2);
  border: 1px solid var(--border);
}
